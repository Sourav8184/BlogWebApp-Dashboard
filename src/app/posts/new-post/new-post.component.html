<div class="add-post container py-5">
  <div class="row mb-4 text-center">
    <div class="col">
      <h3 class="fw-bold post-title">{{ "ADD_NEW_POST" | translate }}</h3>
      <p class="text-muted">{{ "ADD_NEW_POST_SUBTITLE" | translate }}</p>
    </div>
  </div>

  <form [formGroup]="postForm" (ngSubmit)="submitPost()">
    <div class="row g-4">
      <!-- LEFT SIDE -->
      <div class="col-md-7">
        <div class="card shadow-effect bg-theme-secondary rounded-4">
          <div class="card-body p-4">
            <!-- Title -->
            <div class="mb-3">
              <label for="postTitle" class="form-label fw-semibold">
                {{ "POST_TITLE" | translate }}
              </label>
              <input
                id="postTitle"
                type="text"
                class="form-control form-control-lg"
                placeholder="{{ 'POST_TITLE_PLACEHOLDER' | translate }}"
                formControlName="title"
                (keyup)="onTitleChange($event)"
              />
              <small
                class="text-danger"
                *ngIf="
                  postForm.get('title')?.touched &&
                  postForm.get('title')?.invalid
                "
              >
                Title is required.
              </small>
            </div>

            <!-- Permalink -->
            <div class="mb-3">
              <label for="postPermalink" class="form-label fw-semibold">
                {{ "POST_PERMALINK" | translate }}
              </label>
              <input
                id="postPermalink"
                type="text"
                class="form-control form-control-lg"
                placeholder="{{ 'POST_PERMALINK_PLACEHOLDER' | translate }}"
                formControlName="permalink"
                readonly
              />
            </div>

            <!-- Excerpt -->
            <div class="mb-3">
              <label for="postExcerpt" class="form-label fw-semibold">
                {{ "POST_EXCERPT" | translate }}
              </label>
              <textarea
                id="postExcerpt"
                rows="11"
                class="form-control"
                formControlName="excerpt"
                placeholder="{{ 'POST_EXCERPT_PLACEHOLDER' | translate }}"
              ></textarea>
              <small
                class="text-danger"
                *ngIf="
                  postForm.get('excerpt')?.touched &&
                  postForm.get('excerpt')?.invalid
                "
              >
                Excerpt is required.
              </small>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT SIDE -->
      <div class="col-md-5">
        <div class="card shadow-effect bg-theme-secondary rounded-4 p-4">
          <!-- Category -->
          <div class="mb-3">
            <label for="postCategory" class="form-label fw-semibold">{{
              "POST_CATEGORY" | translate
            }}</label>
            <select
              id="postCategory"
              class="form-control form-control-lg"
              formControlName="category"
            >
              <option value="">{{ "POST_CATEGORY_SELECT" | translate }}</option>
              <option *ngFor="let cat of categories" [ngValue]="cat">
                {{ cat.name }}
              </option>
            </select>
            <small
              class="text-danger"
              *ngIf="
                postForm.get('category')?.touched &&
                postForm.get('category')?.invalid
              "
            >
              Category is required.
            </small>
          </div>

          <!-- Image Upload -->
          <div class="mb-3">
            <label for="postImage" class="form-label fw-semibold">{{
              "POST_IMAGE" | translate
            }}</label>

            <div class="image-preview-container mb-2">
              <img [src]="imgSrc" alt="Preview" class="img-preview" />
            </div>

            <input
              id="postImage"
              type="file"
              class="form-control form-control-lg"
              accept="image/*"
              (change)="showPreview($event)"
              formControlName="imgPreview"
            />

            <small
              class="text-danger"
              *ngIf="
                postForm.get('imgPreview')?.touched &&
                postForm.get('imgPreview')?.invalid
              "
            >
              Image is required.
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- CONTENT EDITOR -->
    <div class="row mt-4">
      <div class="col">
        <div class="card shadow-effect rounded-4">
          <div class="card-body p-4">
            <label for="postContent" class="form-label fw-semibold">{{
              "POST_CONTENT" | translate
            }}</label>
            <quill-editor
              id="postContent"
              formControlName="content"
            ></quill-editor>
            <small
              class="text-danger"
              *ngIf="
                postForm.get('content')?.touched &&
                postForm.get('content')?.invalid
              "
            >
              Content is required.
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- BUTTONS -->
    <div class="d-flex justify-content-center gap-3 mt-4">
      <button
        type="submit"
        class="btn btn-lg btn-theme-primary px-4"
        [disabled]="postForm.invalid"
      >
        <i class="fa-solid fa-floppy-disk me-2"></i>
        {{ "SAVE_POST" | translate }}
      </button>

      <button
        type="button"
        class="btn btn-theme-light btn-lg px-4"
        routerLink="/posts"
      >
        <i class="fa-solid fa-arrow-left me-2"></i>
        {{ "BACK_TO_POSTS" | translate }}
      </button>
    </div>
  </form>
</div>
